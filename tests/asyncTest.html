<!DOCTYPE HTML>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
<head>
		<meta charset="utf-8">
		<title>Smoosic Editor</title>
		<link href="../build/styles/fonts.css" rel="stylesheet">
        <link href="../build/styles/media.css" rel="stylesheet">
        <link href="../build/styles/ribbon.css" rel="stylesheet">
        <link href="../build/styles/dialogs.css" rel="stylesheet">
        <link href="../build/styles/menus.css" rel="stylesheet">
        <link href="../build/styles/piano.css" rel="stylesheet">
        <link href="..//build/styles/tree.css" rel="stylesheet">
        <script type="text/javascript" src="https://aarondavidnewman.github.io/vexflow_smoosic/release-webpack/vexflow-debug.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.6.0/jszip.min.js" integrity="sha512-uVSVjE7zYsGz4ag0HEzfugJ78oHCI1KhdkivjQro8ABL/PRiEO4ROwvrolYAcZnky0Fl/baWKYilQfWvESliRA==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
        <!-- script type="text/javascript" src="../../../vex_smoosic/vexflow_smoosic/build/vexflow-debug.js"></script  -->
        <script type="text/javascript" src="https://code.jquery.com/jquery-3.3.1.slim.js" ></script>
		<script type="text/javascript" src="../build/smoosic.js" ></script>
    <script type="text/javascript">
           document.addEventListener("DOMContentLoaded", function (event) {
               // A simple music program using Smoosic in library mode.  We perform async
               // actions so the selections and music will be in sync as the music changes
               var app = async (Smo) => {
                 // create the app in library mode (no UI)
                 // Create an empty score (1 measure rests)
                 const score = Smo.SmoScore.deserialize(Smo.emptyScoreJson);
                 score.preferences.autoPlay = false; // kind of annoying for this demo

                 // Create the renderer that renders the music.  SVG music will be created
                 // in the element
                 const renderer = Smo.SuiScoreRender.createScoreRenderer(document.getElementById('container1'), score);
                 // Create and start the view object.
                 // The outer container DOM is for scrolling
                 const view = new Smo.SuiScoreViewOperations(renderer, score, '#outer-container');
                 view.startRenderingEngine();

                 // Convienence object that sends a command to the view object, and
                 // returns a promise that is resolved when the change is rendered
                 const action = Smo.SuiActionPlayback.actionPromises;
                 const setPitches = Smo.SuiActionPlayback.setPitches;

                 // render the initial score (1 empty measure)
                 await renderer.renderPromise();

                 // Select 1st 2 quarters and make them into 16ths by 1/2 their duration twice
                 await action(view, 'growSelectionRight', [], 1);
                 await action(view, 'batchDurationOperation', ['halveDuration'], 2);
                 await action(view, 'moveSelectionLeft', [], 1);
                 await action(view, 'moveSelectionRight', [], 1);

                 // Set some pitches.  Auto-advance moves the cursor to the left
                 // SmoScore.preferences can toggle auto-advance and auto-play
                 // setPitch sets the key-appropriate note for the given letter.
                 await setPitches(view, 'cdefdec');

                 // Set the notes we just made down the octave by selecting them
                 // Transpose works relative to the pitch and does not auto-advance
                 await action(view, 'moveSelectionLeft', [], 1);
                 await action(view, 'growSelectionLeft', [], 6);
                 await action(view, 'transposeSelections', [-12], 1);

                 // Create 4 1/8 note at end
                 await action(view, 'moveSelectionRight', [], 1);
                 await action(view, 'growSelectionRight', [], 1);
                 await action(view, 'batchDurationOperation', ['halveDuration'], 1);
                 await action(view, 'moveSelectionLeft', [], 1);
                 await action(view, 'moveSelectionRight', [], 1);
                 await setPitches(view, 'gcbc');

                 await action(view, 'moveSelectionLeft', [], 1);
                 // Add a turn on the next tick
                 await action(view, 'toggleArticulation',
                   [
                     "mordent_inverted",
                     "SmoOrnament"
                   ], 1);
                 await action(view, 'moveSelectionRight', [], 1);

                 // Beam the 8th notes and the 16th notes
                 await action(view, 'growSelectionLeft', [], 3);
                 await action(view, 'transposeSelections', [12], 1);
                 await action(view, 'beamSelections', [], 1);
                 await action(view, 'moveSelectionLeft', [], 1);
                 await action(view, 'growSelectionLeft', [], 3);
                 await action(view, 'beamSelections', [], 1);

                 // Add measure after this one
                 await action(view, 'addMeasure', [true], 1);
                 await action(view, 'moveSelectionRight', [], 5);
                 await action(view, 'growSelectionRight', [], 1);
                 await action(view, 'batchDurationOperation', ['halveDuration'], 2);
                 await action(view, 'moveSelectionLeft', [], 1);
                 await action(view, 'moveSelectionRight', [], 1);
                 await action(view, 'moveSelectionLeft', [], 1);
                 await action(view, 'moveSelectionRight', [], 1);
                 await setPitches(view, 'dgabcabg');
                 await action(view, 'growSelectionRight', [], 1);
                 await action(view, 'batchDurationOperation', ['halveDuration'], 1);
                 await action(view, 'moveSelectionLeft', [], 1);
                 await action(view, 'moveSelectionRight', [], 1);
                 await setPitches(view, 'dgfg');
                 await action(view, 'moveSelectionLeft', [], 1);
                 // Add a turn on the next tick
                 await action(view, 'toggleArticulation',
                   [
                     "mordent_inverted",
                     "SmoOrnament"
                   ], 1);
                 await action(view, 'moveSelectionRight', [], 1);
                 await action(view, 'growSelectionLeft', [], 3);
                 await action(view, 'beamSelections', [], 1);
                 await action(view, 'moveSelectionLeft', [], 1);
                 await action(view, 'growSelectionLeft', [], 6);
                 await action(view, 'transposeSelections', [-12], 1);
                 await action(view, 'moveSelectionLeftMeasure', [], 1);

                 // Add the bass cleff staff.  It automatically adds
                 // all the measures
                 await action(view, 'addStaff', [{
                   instrumentInfo: {
                     "instrumentName": "Bass Clef Staff",
                     "keyOffset": 0,
                     "clef": "bass"
                   }
                 }], 1);
                 await action(view, 'moveSelectionDown', [], 1);
                 await action(view, 'batchDurationOperation', ['doubleDuration'], 1);
                 await action(view, 'moveSelectionRight', [], 1);
                 await action(view, 'growSelectionRight', [], 1);
                 await action(view, 'batchDurationOperation', ['halveDuration'], 2);
                 await action(view, 'moveSelectionLeft', [], 1);
                 await action(view, 'moveSelectionRight', [], 2)
                 await setPitches(view, 'cdefdec');
                 await action(view, 'moveSelectionLeft', [], 1);
                 await action(view, 'growSelectionLeft', [], 3);
                 await action(view, 'beamSelections', [], 1);
                 await action(view, 'moveSelectionRight', [], 1);
                 await action(view, 'batchDurationOperation', ['halveDuration'], 1);
                 await setPitches(view, 'g');
                 await action(view, 'moveSelectionLeft', [], 3);
                 await action(view, 'transposeSelections', [12], 1);
                 await action(view, 'moveSelectionRight', [], 1);
                 await action(view, 'toggleArticulation',
                   [
                     "staccato",
                     "SmoArticulation"
                   ], 1);
                 await action(view, 'growSelectionLeft', [], 1);
                 await action(view, 'slur', [], 1);
                 await action(view, 'moveSelectionRight', [], 2);
                 await action(view, 'growSelectionRight', [], 2);
                 await action(view, 'batchDurationOperation', ['halveDuration'], 2);
                 await action(view, 'moveSelectionLeft', [], 1);
                 await action(view, 'moveSelectionRight', [], 2);
                 await setPitches(view, 'gabcabg');
                 await action(view, 'growSelectionLeft', [], 3);
                 await action(view, 'beamSelections', [], 1);

                 // Add measure after this one.  Both staffs get the new measure
                 // and it is populated with rests
                 await action(view, 'addMeasure', [true], 1);
                 await action(view, 'moveSelectionUp', [], 1);
                 await action(view, 'moveSelectionRightMeasure', [], 1);
                 await action(view, 'growSelectionRight', [], 3);
                 await action(view, 'batchDurationOperation', ['halveDuration'], 2);
                 await action(view, 'moveSelectionLeft', [], 1);
                 await action(view, 'moveSelectionRight', [], 1);
                 await setPitches(view, 'eagfegfagfedcedf');
                 await action(view, 'moveSelectionDown', [], 1);
                 await action(view, 'growSelectionRight', [], 3);
                 await action(view, 'batchDurationOperation', ['halveDuration'], 1);
                 await action(view, 'moveSelectionLeft', [], 1);
                 await action(view, 'moveSelectionRight', [], 1);
                 await setPitches(view, 'cbcdegab');
                 await action(view, 'growSelectionLeft', [], 3);
                 await action(view, 'beamSelections', [], 1);

                 await action(view, 'moveSelectionLeft', [], 1);
                 await action(view, 'growSelectionLeft', [], 3);
                 await action(view, 'beamSelections', [], 1);
                 await action(view, 'moveSelectionRight', [], 1);
                 await action(view, 'growSelectionLeft', [], 3);
                 await action(view, 'slur', [], 1);
                 await action(view, 'moveSelectionRight', [], 1);
                 await action(view, 'growSelectionRight', [], 2);
                 await action(view, 'slur', [], 1);
                 await action(view, 'transposeSelections', [-12], 1);

                 // It's starting to get kind of crowded.  Set the svgScale to 60%
                 // to make the notes smaller.
                 await action(view, 'setScoreLayout',
                   [{
                     "leftMargin": 30,
                     "rightMargin": 30,
                     "topMargin": 40,
                     "bottomMargin": 40,
                     "pageWidth": 816,
                     "pageHeight": 1056,
                     "orientation": 0,
                     "interGap": 30,
                     "intraGap": 10,
                     "svgScale": 0.6,
                     "zoomScale": 2.1,
                     "zoomMode": 0,
                     "noteSpacing": 1,
                     "pages": 1
                   }], 1);

               };
                 Smo.SuiApplication.configure({
                   mode: 'library',
                   idleRedrawTime: 500
                 });
               app(Smo);
           });
       </script>
</head>
<body>
  <!-- audio crossOrigin="anonymous" id="sample" src="https://aarondavidnewman.github.io/Smoosic/build/sound/piano_middle_C.mp3" / -->
  <div id="outer-container">
    <div id="container1">

    </div>
  </div>
</body>
</html>
